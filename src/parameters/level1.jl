# global constans
const p = BigInt(2)^247 * 79 - 1
R, T = polynomial_ring(GF(p), "T")
const Fp2, Fp2_i = finite_field(T^2 + 1, "i")
const ExponentFull = 247
const ExponentForIsogeny = 110
const ExponentForTorsion = 137
const Cofactor = 79

const KLPT_repres_num_gamma_trial = 16384
const SmallPrimes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97]

# constatns from precompute/level1torsion.sage
const P2e = Point(13168888026701864374327984987573149335323956272359708223115375240549648163281*Fp2_i + 2161215833780113725019607471924727440013124162519025392101162565499276343954, 11573631817917175655308717998954552340066289950952953708354522787290655314842*Fp2_i + 9830874140031968764629465062081177133088386698799679322612340559956021219521)
const Q2e = Point(1167679482150863195523978450170412562715924357238602796020786585710888718237*Fp2_i + 195807475550494427451649608271104515847911618849141017426569917821137983194, 4862877640333236516853362674124171341900551523228923073125804599913941126908*Fp2_i + 12087566741318956310016631707446387960429051679627903688618432549189813607113)
const M_i_2e = [187804641856894237833666302824508355834507214682716838694549490552883968291 168588957679671372271042170869802553932047472501894436463898332476278883566; 156173985651354320464277040484803017418920522788064441193166373616243357181 38351782434738956352995777270585214191410724117362387945016103212571363037]
const M_ij_2e = [89525985884981099413626375992466343353718007666384484912145770930619405320 86203614543351285271659433268311087941489690539722696159230979111204858683; 106676124532956136778423656701829964547672032461408105458899705516857934656 136630438406652094773035704102627226672199931133694741727419822834835926008]
const M_1k_2e = [47293392636392707013109095476030301705868389346246377929798957148812719464 197979047349103652112761733725205039071613847918896028361337091949765817183; 144102115607646079774418655445238838719570865336332827004198219044290149848 178863031655240487173552984619063268320049549453832848709766636616642611865]

const wp_P2e_Q2e = Weil_pairing_2power(Fp2(0), P2e, Q2e, ExponentFull)

@assert wp_P2e_Q2e^(BigInt(2)^(ExponentFull-1)) != 1
@assert wp_P2e_Q2e^(BigInt(2)^ExponentFull) == 1
